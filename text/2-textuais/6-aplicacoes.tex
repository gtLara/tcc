\chapter{Aplicação}
\label{chap:aplicacoes}

\section{Definição de Problema}

O problema abordado é definido de maneira propositalmente vaga devido à
limitações impostas por sigilo industrial.

No seguinte capítulo é realizada uma análise de correntes de motores elétricos
a fim de detectar anomalias em sua operação. Na situação estudada múltiplos
motores de indução são responsáveis pelo funcionamento de uma esteira
industrial que transporta um produto em uma das etapas de sua fabricação. Os
motores estão acoplados à mesma esteira e a corrente é medida de forma
monofásica na barra de uma de suas gaiolas (TODO: confirmar onde é medida a
corrente e se descrição de medição está ok). Detalhes sobre o processo de
fabricação e produto em si não podem ser compartilhadas e não são
particularmente interessantes para a abordagem deste trabalho, que se limita
aos sinais de corrente. Basta esclarecer que em operação normal a esteira opera
em velocidade constante, enquanto sob operação anômala um acúmulo indesejado do
material transportado gera uma diminuição irregular de sua velocidade.

A partir dessa breve descrição do problema podemos delimitar o escopo do
material utilizado na seguinte análise como exclusivamente os sinais de
corrente dos motores. Nota-se que considerável progresso pode ser feito a
partir de análises dos sistemas de controle de motores de indução, como em
~\cite{}. Quanto à fundamentação teórica, serão utilizados conceitos discutidos
ao longo dos últimos capítulos.

A limitação da análise às correntes leva à necessidade da definição de um
evento anômalo a nível deste sinal para que seja possível gerar algum tipo de
procedimento para sua identificação. Essa definição é realizada \emph{a priori}
por meio de uma rotulação do momento em que a anomalia foi percebida pelos
operadores do processo. Dessa maneira o problema pode ser considerado como
supervisionado.

O desenvolvimento a seguir analisa dois grupos de intervalos de correntes
correspondentes aos modos de operação normal e anômalo. Os procedimentos
terão como objetivo expor tendências indicativas dos eventos anômalos.

\subsection{Problemas de operacionalização}

A resolução do problema abordado será desenvolvida levando em conta fatores que
dificultariam a implementação de seus procedimentos em tempo real. Supondo que
seja desenvolvida uma aplicação capaz de distinguir entre as classes descritas
no início deste capítulo, sua operacionalização requer que seus procedimentos
sejam capazes de funcionar em tempo real e de forma contínua. Além disso sua
infraestrutura deve ser interpretável, documentada e reprodutível. A partir
destas considerações enumera-se três grandes problemas de operacionalização
que serão abordados neste trabalho:

\begin{enumerate}
    \item \textbf{Funcionamento em tempo real e contínuo}: Quaisquer modelos
    envolvidos devem não somente realizar inferência em tempo hábil mas também
    se adaptar a mudanças nas características dos sinais como regime de
    operação e conteúdo espectral.
    \item \textbf{Reprodutibilidade}: A infraestrutura de processamento de
    sinais, fluxo de dados, modelagem e inferência deve ser absolutamente
    reprodutível para que a solução seja implementável e passível a manutenção
    ao longo do tempo.
    \item \textbf{Documentação}: O código utilizado nos procedimentos
    envolvidos na solução devem ser apropriadamente documentados pelas mesmas
    motivações do ponto anterior.
\end{enumerate}

A fim de endereçar cada uma dessas preocupações as seguintes considerações são
estabelecidas.

\subsubsection{Funcionamento em tempo real e contínuo}

A necessidade de modelagem adaptativa sugere o uso de modelos
estruturais~\cite{structural}, também chamados de bayesianos ou de espaço de
estados, para a representação de qualquer dinâmica de interesse das séries
temporais. A formulação dos modelos abordados nesse trabalho de forma
estrutural permite a atualização bayesiana de seus parâmetros de acordo com
novas amostras da variável prevista, essencialmente representando uma
formulação \emph{online} de modelos lineares. O algoritmo canônico para
atualização dos parâmetros de um modelo estrutural é o filtro de
Kalman~\cite{kalman}.

Em particular podem ser desenvolvidos modelos estruturais para as componentes
de tendência e sazonalidade de uma série periódica. Modelos de sazonalidade
estruturais exigem parametrizações mais complexas para o filtro de Kalman
quando comparados aos de tendência. Como consequência, nesse trabalho será
usado um modelo estrutural apenas para a tendência.

\subsubsection{Reprodutibilidade}

O requisito de reprodutibilidade do \emph{pipeline} de processamento de dados
pode ser atendido por uma série de programas auxiliares. É indispensável,
antes de tudo, que o código seja desenvolvida em um sistema de
versionamento \emph{git}, para que haja um claro histórico, isolamento de
tarefas e desenvolvimento incremental. A nível de infraestrutura em si
é interessante que seja usado algum programa análogo ao \verb+make+. O
\verb+DVC+, abreviação de \emph{Data Version Control}, é uma aplicação que
busca atender a diversas necessidades de projetos de dados, uma delas sendo
justamente a estruturação de \emph{pipelines} reprodutíveis e orientados por
\emph{Dynamic Acyclic Graphs}, semelhante ao \verb+make+. A solução
desenvolvida será então organizada como um \emph{pipeline} DVC.

\subsubsection{Documentação}

A demanda de documentação será atendida seguindo o princípio de evitar códigos
em comentários~\cite{clean_code}. Usando do recurso de \emph{docstrings} da
linguagem \verb+Python+, na qual a aplicação será desenvolvida, a documentação
será escrita a nível de funções seguindo o padrão do projeto Sphinx
~\cite{sphinx}, no intuito de gerar um texto automaticamente a partir das
\emph{docstrings}.

\subsection{Descrição dos Dados}

Os sinais representam as correntes individuais das gaiolas de dezessete
motores, configurando uma série temporal multivariada. A série é sincronizada,
isso é, suas amostras entre componentes distintas são realizadas em instantes
idênticos no tempo.

O fornecedor dos sinais oferece duas taxas de amostragem: $100Hz$,
representando a taxa de amostragem real dos instrumentos de medição, e $1Hz$,
resultado de uma subamostragem do sinal original para maior facilidade de
transmissão. Os sinais originais, amostrados a $100Hz$, não são fáceis de se
obter. Como consequência o presente estudo é limitado no que tange à quantidade
de dados. Uma propriedade positiva da abordagem empregada é sua validade mesmo
na presença de poucos dados. Dessa forma, uma das contribuições desse trabalho
é justamente a extração de padrões úteis a partir de poucos dados.

A seguinte figura ilustra um grupo de nove séries temporais sob um intervalo
de tempo de três minutos em operação normal.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{figures/current_signal_demos.png}
    \caption{Exemplo de nove dos dezessete sinais de corrente em um intervalo
    arbitrário de três minutos em operação normal.}
    \label{fig:demo}
\end{figure}

Observamos pela imagem~\ref{fig:demo} que as correntes enumeradas exibem um
perfil muito semelhante entre si: forte estrutura sazonal, interjeições de alta
frequência em instantes semelhantes e uma tendência com pequenas variações em
torno de um nível fixo. Note que a intensidade das correntes é indicada em
porcentagem da intensidade máxima.

A seguinte figura é semelhante à figura~\ref{fig:demo}, agora representando os
três minutos antecedentes ao evento anômalo.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{figures/sucata_current_signal_demos.png}
    \caption{Exemplo de nove dos dezessete sinais de corrente em um intervalo
    arbitrário de três minutos em operação anômala.}
    \label{fig:demo_anomalous}
\end{figure}

Comparando as imagens~\ref{fig:demo} e~\ref{fig:demo_anomalous} é conclusivo
que, no caso dessa anomalia em específico, não há sinais visuais claros de sua
ocorrência.

A semelhança entre os sinais enumerados  sugere que o seu uso em conjunto pode
ser redundante. A seção~\ref{ssec:ccorr} avalia essa hipótese de forma
quantitativa.

Na seguinte seção a estrutura observada nos sinais será analisada em maior
profundidade.


\subsubsection{Sumarização}

A análise será realizada em um conjunto de sinais que contém uma ocorrência de
anomalia. A tabela~\ref{tab:summ} informa algumas estatísticas descritivas do
sinal de um motor em regime de normalidade e em regime de anomalia.
Considera-se o regime anômalo como os dez minutos anteriores ao momento
registrado da anomalia.

\begin{table}[H]
\label{tab:summ}
\begin{tabular}{|l|l|l|}
\hline
           & \textbf{Normalidade} & \textbf{Anomalia} \\ \hline
Média      & 59.13                &  65.86            \\ \hline
Variância  & 18.17                &  21.56            \\ \hline
\emph{Skew}& 0.14                 &  -0.02            \\ \hline
Duração    & 5 horas              &  10 minutos       \\ \hline
Amostragem &  100 Hz              &  100 Hz           \\ \hline
\end{tabular}
\end{table}

\section{Análise de Propriedades das Séries Temporais}

Nessa seção as propriedades de correlação cruzada, tendência e sazonalidade
das séries temporais são analisadas. Por fim possíveis soluções são propostas.

\subsection{Correlação Cruzada}\label{ssec:ccorr}

Uma análise de correlação cruzada instantânea, isso é, desconsiderando
correlações em função de atrasos, é interessante para determinar quão
semelhantes os sinais são entre si de forma mais quantitativa do que a
figura~\ref{fig:demo}. Essa informação é útil por determinar quais séries devem
ser mantidas na análise a seguir: um subconjunto com alta correlação
instantânea entre si indica que seu processamento em paralelo é redundante.
Além disso, o perfil de autocorrelação instantânea pode ser indicador do regime
de operação: é possível que essa relação seja muito distinta entre os regimes
de operação anômalos e de normalidade.

As matrizes visualizadas a seguir ilustram as correlações instantâneas entre as
séries temporais em ambos os regimes de operação. As matrizes foram geradas
pela amostragem uniforme de segmentos contínuos e disjuntos de dez minutos de
duração das correntes. Limitado pelo número de eventos anômalos foram
selecionados cinco intervalos. A estacionariedade das séries, estudada na
subseção seguinte, permite que essa pequena amostra seja representativa das
correlações instantâneas gerais.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/correlation_matrix.png}
    \caption{Matriz de correlação instantânea entre séries temporais sob
    regime de normalidade.}
    \label{fig:demo_matrix}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/anomalous_correlation_matrix.png}
    \caption{Matriz de correlação instantânea entre séries temporais sob
    regime de anomalia.}
    \label{fig:demo_matrix_anomaly}
\end{figure}

Inicialmente observamos que em ambas as figuras há certas regiões de alta
correlação que indicam grupos de sinais semelhantes entre si. Destacam-se os
dois grupos formados pelas correntes enumeradas de seis a nove e de dez a
dezesseis. Esses subconjuntos justificam a exclusão dos sinais enumerados sete
a nove e onze a dezesseis.

Comparando as figuras~\ref{fig:demo_matrix} e~\ref{fig:demo_matrix_anomaly},
observamos que sob regime de anomalia há ligeiramente maior correlação cruzada
entre os sinais, um primeiro sinal de diferença visível entre os dois regimes.
No entanto, essa diferença não aparenta ser expressiva o suficiente para gerar
algum tipo de discriminação eficiente.

\subsection{Tendência}

A presença de tendência para além de uma constante é evidenciada pela
figura~\ref{fig:demo}, característica que se mantém em quaisquer outros
intervalos válidos das correntes. A figura~\ref{fig:loess} ilustra o uso do
algoritmo LOESS para aproximar um padrão de tendência subjacente a um curto
trecho de um dos sinais. Maneiras mais rigorosas de detectar a presença de
tendência incluem testes estatísticos e análise de autocorrelação, cuja
aplicação no caso presente é desnecessária devido à aparência da tendência.

\subsection{Estacionariedade}

A consistência na estrutura observada sugere a possibilidade de
estacionariedade das séries. De fato, ao executar o teste estatístico de
\emph{Augmented Dickey Fuller} os p-valores observados são consistentemente
estatisticamente indistinguíveis de zero. Essa conclusão se repete para
diversos métodos de amostragem de subsegmentos contínuos dos sinais. Note
que a estacionariedade foi detectada em intervalos de quinze minutos.

Diante desses resultados, é seguro concluir que as séries são localmente
estacionárias em janelas de no mínimo quinze minutos para ambos regimes. É
possível que cada sinal seja globalmente estacionário (no escopo de
funcionamento da planta), mas isso não será presumido nem investigado.
Essa observação é essencial para vários passos das análises a seguir.

\subsection{Sazonalidade}

O padrão de sazonalidade evidentemente presente nos sinais pode ser melhor
inspecionado por meio de suas autocorrelações, que são constantes ao longo do
tempo como consequência de estacionariedade. As figuras~\ref{fig:demo_acorrs}
e~\ref{fig:anomalous_demo_acorrs} ilustram as autocorrelações correspondentes
aos sinais das figuras~\ref{fig:demo} e~\ref{fig:demo_anomalous},
respectivamente.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/current_signal_acorrs.png}
    \caption{Exemplo de autocorrelação de nove dos dezessete sinais de corrente
    em um intervalo arbitrário de três minutos em operação normal.}
    \label{fig:demo_acorrs}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/sucata_current_signal_acorrs.png}
    \caption{Exemplo de autocorrelação de nove dos dezessete sinais de corrente
    em um intervalo arbitrário de três minutos em operação anômala.}
    \label{fig:anomalous_demo_acorrs}
\end{figure}

As imagens demonstram um padrão sazonal coerente com o observado nos sinais no
domínio do tempo, com um período grande relativo ao de amostragem. Uma
comparação das imagens~\ref{fig:anomalous_demo_acorrs} e~\ref{fig:demo_acorrs}
leva à observação de que os primeiros picos de autocorrelação dos sinais em
regime anômalo ocorrem ligeiramente antes. Essa característica pode ser útil
para discriminar entre os dois regimes e é estudada de forma quantitativa
na seção~\ref{ssec:}.

\subsection{Possíveis Soluções}

Com as análises exploratórias realizadas anteriormente há embasamento para
propor possíveis soluções. Duas propriedades que imediatamente se destacam são
a presença de tendência e sazonalidade bem definidas, sugerindo a possibilidade
do uso de decomposição linear (seção ~\ref{sec:decomposition}) de forma a melhor
representar a anomalia que se deseja identificar. Nota-se que um dos principais
usos de decomposição é justamente detecção de anomalia
~\cite{anomaly_detection_decomposition}.

Outra conclusão notável da análise conduzida é a estacionariedade das séries.
Essa propriedade permite uma representação espectral simples para cada
corrente, correspondente à transformada de Fourier de suas autocorrelações. O
fato das autocorrelações de sinais em regime anômalo apresentarem picos em um
número inferior de atrasos pode refletir em um conteúdo espectral mais
enviesado para altas frequências, gerando uma \emph{feature} discriminativa.

Dessa forma delimitam-se duas tentativas de detecção do regime de anomalia:

\begin{enumerate}
    \item Exposição de algum padrão evidentemente anômalo por meio de decomposição linear
    \item Uso de representação em frequência como característica discriminativa
\end{enumerate}

\section{Decomposição Linear}

Conforme estabelecido, há motivação para utilizar decomposição linear em uma
tentativa de extrair sinais mais evidentes do comportamento anômalo nas séries
temporais, devido à estrutura fortemente sazonal presente nas séries sob
análise e uma visível tendência.

A modelagem de tendência será realizada por meio de um simples modelo
estrutural com nativa capacidade de adaptação via filtro de Kalman. A modelagem
da sazonalidade será realizada pelo método do padrão médio devido ao ``custo
benefício'' associado à sua simplicidade e eficiência, considerando que a
frequência do padrão sazonal não varia o suficiente para justificar o uso de
um modelo estrutural como no caso da tendência. Note
que a estacionariedade da série permite que o padrão extraído seja utilizado
por um intervalo não desprezível de tempo. À medida que o padrão
inevitavelmente se desatualizar devido a variações na frequência é possível
calculá-lo novamente. Um mecanismo de reajuste do modelo sazonal será então
desenvolvido a partir de um gatilho de erro. Por fim os resíduos da
decomposição serão analisados essencialmente como uma nova versão da série
original. A expectativa é que estes resíduos sejam muito mais representativos
dos regimes de normalidade e anomalia.

As séries serão modeladas de forma individual na esperança que seja possível
expor a anomalia a partir de uma única série, logo os modelos desenvolvidos
são univariados.

\subsection{Modelagem de Tendência}

O modelo estrutural assumido para a tendência é conhecido como modelo de nível
local, com equações de estado e saída dadas por~\ref{eq:state} e
~\ref{eq:measurement}. Nota-se que as inovações $\eta_t$ e $\varepsilon_t$ são
independentes e identicamente distribuídas por distribuições normais centradas
em zero com variância $\sigma^2_{\eta}$ e $\sigma^2_{\varepsilon}$
respectivamente.

\begin{equation}\label{eq:state}
    \mu_{t+1} = \mu_t + \eta_t
\end{equation}

\begin{equation}\label{eq:measurement}
    y_t = \mu_t + \varepsilon_t
\end{equation}

O filtro de Kalman é usado para estimar a tendência ao longo do sinal.

O estado inicial será definido com média correspondente à média do sinal cuja
tendência será modelada e variância unitária. As matrizes de covariância de
transição e saída são, devido ao fato do modelo ser univariado, escalares.
Esses valores são definidos como unitários.

Define-se por fim $\sigma^2_{\eta} = 1^{-7}$ e $\sigma^2_{\varepsilon} = 1$.

A modelagem da tendência de um segmento de sinal arbitrário por meio destas
especificações é ilustrada pela figura~\ref{fig:kalman_trend}. Nota-se
que o sinal é transformado por um filtro média móvel com janela de $50$
amostras antes de ser submetido à estimativa do filtro de Kalman, a fim de
garantir que as atualizações realizadas pelo filtro sejam robustas ao ruído
de alta frequência.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/kalman_trend.png}
    \caption{Exemplo de modelagem de tendência via modelo de nível local e
    filtro de Kalman}
    \label{fig:kalman_trend}
\end{figure}

O uso do filtro de Kalman permite que novas amostras sejam incorporadas em
tempo real para que a estimativa da tendência seja realizada de forma
\emph{online}.

\subsection{Modelagem de Sazonalidade}

A abordagem para modelagem de sazonalidade será o cálculo do padrão sazonal
médio, conforme a seção~\ref{sec:mean_season}. Essencial para o funcionamento
desse método é a determinação correta do período do padrão sazonal. É
indispensável que esse valor seja determinado de forma automática pela
multiplicidade de séries temporais e pela necessidade de contínuo cálculo de
padrões sazonais. A forma mais direta de obter esse valor é pelo número de
atrases necessários para a função de autocorrelação atingir seu primeiro
máximo local, como ilustrado pela figura~\ref{fig:acorr_peak}.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/autocorrelation_peak_example.png}
    \caption{Perfil de autocorrelação de uma janela arbitrária de dez minutos
    de operação normal. O intervalo entre as linhas vermelhas horizontais
    corresponde ao período do padrão sazonal.}
    \label{fig:acorr_peak}
\end{figure}

Extraído este valor é possível prosseguir com a determinação do padrão sazonal.
A imagem~\ref{fig:mean_seasonal_pattern} ilustra o cálculo do padrão sazonal
médio. As linhas em vermelho representam os segmentos do sinal resultantes de
sua partição em trechos de comprimento correspondente ao período sazonal
encontrado e o sinal preto representa o padrão sazonal médio entre os sinais em
vermelho. A componente sazonal é então gerada pela sucessiva concatenação do
padrão encontrado.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.8]{figures/seasonal_pattern.png}
    \caption{Visualização de computação de padrão sazonal médio.}
    \label{fig:mean_seasonal_pattern}
\end{figure}

A modelagem de tendência e sazonalidade essencialmente conclui o processo de
decomposição. O produto deste procedimento, denominado por resíduos, resulta da
substração destas componentes do sinal original.

\subsection{Análise de Resíduos}

Finalizado o processo de decomposição são obtidos os resíduos. A decomposição
de um trecho arbitrário de um sinal específico correspondendo à oito minutos de
normalidade é visualizada pela figura~\ref{fig:decomposition} onde, de cima
para baixo, observamos o sinal original, tendência, sazonalidade e resíduos. A
figura~\ref{fig:normal_residue} ilustra apenas os resíduos juntamente de sua
autocorrelação. Observamos que há permanência de estrutura nos resíduos,
especificamente de algumas interjeições de alta frequência, mas que de forma
geral o sinal se aproxima mais a um perfil de autocorrelação de ruído branco
do que inicialmente.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/decomposition.png}
    \caption{Visualização de decomposição linear de um trecho de oito
    minutos de sinal em regime de normalidade.}
    \label{fig:decomposition}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/residuals.png}
    \caption{Visualização de resíduos de um segmento de oito minutos de sinal
    em regime de normalidade juntamente de sua autocorrelação.}
    \label{fig:normal_residue}
\end{figure}

Podemos realizar visualizações identicamente análogas para um trecho de oito
minutos em regime anômalo, resultando nas figuras~\ref{fig:anomalous_residue}
e~\ref{fig:decomposition}. Observamos que, conforme desejado, a presença da
anomalia se torna evidente por meio de um padrão no resíduos. No caso dessa
anomalia em específico (e de outras, como será ilustrado) este padrão é uma
forte tendência ou, de forma equivalente, em uma autocorrelação com valores
altos que lentamente decaem.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.5]{figures/anomalous_decomposition.png}
    \caption{Visualização de decomposição linear de um trecho de oito
    minutos de sinal em regime de anomalia. A linha horizontal vermelha
    indica o momento de ocorrência da falha.}
    \label{fig:decomposition}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{figures/anomalous_residuals.png}
    \caption{Visualização de resíduos de um segmento de oito minutos de sinal
    em regime de anomalia juntamente de sua autocorrelação.}
    \label{fig:anomalous_residue}
\end{figure}

O objetivo intermediário de obter um sinal mais representativo da presença de
uma anomalia foi atingido. A fim de de fato detectar a anomalia há a
necessidade do emprego de algum tipo de algoritmo com esse objetivo.

\subsubsection{Detecção de Anomalia}\label{ssec:algorithm}

A força da tendência presente nos resíduos resultantes da decomposição linear
do sinal anômalo sugere a possibilidade de usar a inclinação da reta resultante
de uma regressão linear realizada sob uma janela fixa como um indicador de
anomalia. Uma anomalia seria então acusada quando a inclinação da reta
ultrapassar um valor manualmente determinado. Nota-se que logo antes da
ocorrência da tendência há uma trecho do sinal que apresenta média
consideravelmente inferior a de suas redondezas, de forma que a aplicação do
algoritmo proposto resultaria na detecção de uma anomalia ao retomar a
tendência anterior. Esse trecho do sinal representa um outro regime de operação
rotulado, isso é, cuja ocorrência é conhecida. A fim de evitar o falso positivo
decorrente da presença desse outro regime de operação o algoritmo proposto
ignora a transição entre regimes rotulados.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.7]{figures/anomaly_detection.png}
    \caption{Visualização de aplicação do algoritmo de detecção de anomalias
    nos resíduos da decomposição linear de um trecho anômalo.}
    \label{fig:normal_residue}
\end{figure}

Como observado na figura acima a aplicação do algoritmo é bem sucedida na
detecção dessa anomalia específica.

TODO: mencionar sobre detecção de anomalia multivariada aqui !! Colocar imagem
de decomposição múltipla e etc.

\section{Análise Espectral}

A estacionariedade local dos sinais de corrente permite que sejam computadas
suas densidades de potência espectral. Como na seção anterior serão
visualizadas essas funções para janelas em regimes de anomalia e normalidade na
expectativa de gerar uma característica discriminativa. Em seguida uma breve
análise linear de tempo frequência será realizada.

A figura~\ref{fig:psd_signals} ilustra os segmentos de sinais de normalidade e
anomalia que serão analisados. Como já constatado, não há diferença visível
entre os sinais.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/psd_comparison_signals.png}
    \caption{Visualização no tempo de sinais analisados em frequência.}
    \label{fig:psd_signals}
\end{figure}

\subsection{Densidade de Espectro de Potência}

A figura~\ref{fig:psd_comparison} ilustra uma comparação das funções de
densidade de espectro de potência dos sinais ilustrados pela figura
~\ref{fig:psd_signals}. Essas funções foram estimadas pelo método de Welch
~\cite{welch}. Observa-se pouca diferença entre as densidades, além de um
aparente viés do sinal anômalo para distribuição de potência em altas
frequências.

É possível que a janela de observação de dez minutos utilizada seja grande
demais para capturar a variação local de frequência dos sinais. Nesse caso
se torna necessário a utilização de um método capaz de representar o conteúdo
espectral dos sinais de forma variável ao longo do tempo.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.6]{figures/psd_comparison.png}
    \caption{Visualização comparativa de densidade de potência espectral de
    sinais em regime de normalidade e anomalia.}
    \label{fig:psd_comparison}
\end{figure}

\subsection{Espectrograma}

Uma forma natural de analisar a variação temporal instantânea do conteúdo dos
sinais é por meio de um espectrograma. A figura~\ref{fig:spectrograms}
visualiza os espectrogramas dos sinais da figura~\ref{fig:psd_signals}.
Observa-se que, como nos resíduos do sinal decomposto, há visível tendência na
distribuição do conteúdo espectral do sinal anômalo. A extração de alguma
característica espectral pode ser útil para detectar a anomalia. A figura
~\ref{fig:spectrograms_max} visualiza o cálculo do valor máximo de cada
\emph{frame}, sugerindo que esta característica pode ser discriminativa.

Gerada uma característica representativa da anomalia no domínio da frequência
é necessário usá-la para a tarefa de detecção. Como a exposição da anomalia
se deu por meio de uma tendência o algoritmo proposto na seção
~\ref{ssec:algorithm} pode ser empregado a este fim. Alternativamente
algoritmos de classificação de imagem como redes neurais
convolucionais~\ref{cnns} podem ser usadas a partir de qualquer representação
tempo frequência. Nenhuma desses métodos e detecção serão empregados nos
espectrogramas produzidos.

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.8]{figures/spectrogram_comparison.png}
    \caption{Visualização comparativa de espectrogramas de sinais em regime de
    normalidade e anomalia.}
    \label{fig:spectrograms}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=0.8]{figures/max_spectrogram_comparison.png}
    \caption{Visualização comparativa valor máximo dos \emph{frames} de
    espectrogramas de sinais em regime de normalidade e anomalia.}
    \label{fig:spectrograms_max}
\end{figure}

\section{\emph{Pipeline} de Processamento e Modelagem}

\section{Resultados}
